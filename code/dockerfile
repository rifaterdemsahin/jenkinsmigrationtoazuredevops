# Start from the Jenkins LTS image
FROM jenkins/jenkins:lts

# Switch to root user to install Python and related packages
USER root

# Install Python 3, pip, python3-venv, and build-essential
RUN apt-get update && \
    apt-get install -y python3 python3-pip python3-venv build-essential

# Upgrade pip3 to the latest version
RUN pip3 install --upgrade pip

# Create a virtual environment and install pytest
RUN python3 -m venv /home/jenkins/venv
RUN /home/jenkins/venv/bin/pip install pytest

# Switch back to the Jenkins user
USER jenkins

# Expose port 8080
EXPOSE 8080

# Set PATH to include the virtual environment
ENV PATH="/home/jenkins/venv/bin:$PATH"
